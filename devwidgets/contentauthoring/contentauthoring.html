<!-- CSS -->
<link rel="stylesheet" type="text/css" href="/devwidgets/contentauthoring/css/contentauthoring.css" />

<!-- Inserter Bar Widget Container -->
<div id="contentauthoring_inserterbar_container" style="display:none;">
    <div id="widget_inserterbar" class="widget_inline"></div>
</div>

<div class="s3d-dropdown-list" id="contentauthoring_row_menu" style="display:none;">
    <div class="s3d-dropdown-list-arrow-up"></div>
    <ul>
        <li data-columncount="1">
            <button id="contentauthoring_row_menu_one" class="s3d-link-button"><div class="s3d-action-icon fl-force-right s3d-action-icon-spacing-left"></div>1 column</button>
        </li>
        <li data-columncount="2">
            <button id="contentauthoring_row_menu_two" class="s3d-link-button"><div class="s3d-action-icon fl-force-right s3d-action-icon-spacing-left"></div>2 columns</button>
        </li>
        <li data-columncount="3">
            <button id="contentauthoring_row_menu_three" class="s3d-link-button"><div class="s3d-action-icon fl-force-right s3d-action-icon-spacing-left"></div>3 columns</button>
        </li>
        <li class="s3d-dropdown-hassubnav"><button id="contentauthoring_row_menu_add_above" class="s3d-link-button">Add new row</button>
            <ul class="s3d-dropdown-list">
                <li><button id="contentauthoring_row_menu_add_above" class="s3d-link-button"><div class="s3d-action-icon s3d-above-icon fl-force-left s3d-action-icon-spacing-right"></div>Add row above</button></li>
                <li><button id="contentauthoring_row_menu_add_below" class="s3d-link-button"><div class="s3d-action-icon s3d-below-icon fl-force-left s3d-action-icon-spacing-right"></div>Add row below</button></li>
            </ul>
        </li>
        <li><button id="contentauthoring_row_menu_remove" class="s3d-link-button">Remove row</button></li>
    </ul>
</div>

<div id="contentauthoring_widget" class="contentauthoring_widget" style="padding: 10px; clear: both;"></div>
<div id="contentauthoring_widget_template" style="display:none;"><!--
    {macro insertCell(id, type)}
        <div class="contentauthoring_cell_element {if type === "htmlblock"} contentauthoring_init{/if}" data-element-type="${type}" data-element-id="${id}">
            <div class="contentauthoring_cell_element_actions" data-element-id="${id}" data-element-type="${type}">
                <span class="contentauthoring_row_handle fl-force-left" title="Drag me to re-order"></span>
                {if sakai.widgets[type].hasSettings}
                    <span class="contentauthoring_cell_element_action_e fl-force-left" data-element-id="${id}" data-element-type="${type}" title="__MSG__SETTINGS__"></span>
                {/if}
                <span class="contentauthoring_cell_element_action_x fl-force-left" data-element-id="${id}" title="__MSG__DELETE__"></span>
            </div>
            {if template === "cell" && (sakai.widgets[type].hasSettings && !settingsoverridden)}
                <div id="${id}"></div>
            {else}
                <div id="widget_${type}_${id}" class="widget_inline"></div>
            {/if}
        </div>
    {/macro}

    {macro insertColumn(column)}
        <div class="contentauthoring_cell" style="width: ${column.width * 100}%">
            <div class="contentauthoring_cell_container">
                <div class="contentauthoring_table_row">
                    <div class="contentauthoring_cell_content">
                        {for element in column.elements}
                            {if element.dummytext}
                                <div class="contentauthoring_dummy_element" style="display:none;">__MSG__DOUBLE_CLICK_TO_START_TYPING__.</div>
                            {else}
                                ${insertCell(element.id, element.type)}
                            {/if}
                        {forelse}
                            <div class="contentauthoring_dummy_element" style="display:none;">__MSG__DOUBLE_CLICK_TO_START_TYPING__.</div>
                        {/for}
                    </div>
                    <div class="contentauthoring_cell_handle ui-resizable-handle ui-resizable-e"></div>
                </div>
            </div>
        </div>
    {/macro}

    {macro insertRow(id, columns)}
        <li class="contentauthoring_row_container" data-row-id="${id}">
            <div class="contentauthoring_row_handle_container">
                <span class="contentauthoring_row_handle" title="__MSG__DRAG_ME_TO_REORDER_ROWS__"></span>
                <span class="contentauthoring_row_edit" data-row-id="${id}"></span>
            </div>
            <div class="contentauthoring_row">
                <div class="contentauthoring_minheight_container">
                    <div class="contentauthoring_table_row contentauthoring_cell_container_row" data-row-id="${id}">
                        {for column in columns}
                            ${insertColumn(column)}
                            <hr class="fl-hidden fl-push"/>
                        {/for}
                    </div>
                </div>
            </div>
        </li>
    {/macro}

    {if template === "row"}
        ${insertRow(id, columns)}
    {elseif template === "cell"}
        ${insertCell(id, type, settingsoverridden)}
    {elseif template === "column"}
        ${insertColumn(column)}
    {else}
        <ul id="contentauthoring_widget_container">
            {for row in rows}
                ${insertRow(row.id, row.columns)}
            {/for}
        </ul>
        <div id="contentauthoring_no_content_container" style="display:none;"></div>
    {/if}
--></div>

<div id="create_cell_element_template" style="display:none;"><!--
    {if data && data.content && data.content.length}
        {for file in data.content}
            {if file.name}
                <div class="contentauthoring_cell_element {if type === "htmlblock"} contentauthoring_init{/if}" data-element-type="htmlblock" data-element-id="245462465">
                    <div class="contentauthoring_cell_element_actions" style="display:none;" data-element-id="245462465" data-element-type="htmlblock">
                        <button class="contentauthoring_cell_element_action_x">X</button>
                        <button class="contentauthoring_cell_element_action_e">E</button>
                    </div>
                    {var mimeType = sakai.api.Content.getMimeTypeData(file.type)}
                    <img src="${mimeType.URL}" alt="${mimeType.description}" class="s3d-icon-40 fl-force-left"/>
                    <span class="s3d-regular-links fl-force-left s3d-bold s3d-margin-top-15">${file.name}</span>
                    <hr class="fl-hidden fl-push"/>
                </div>
            {/if}
        {/for}
    {else}
        <div class="contentauthoring_cell_element {if type === "htmlblock"} contentauthoring_init{/if}" data-element-type="htmlblock" data-element-id="245462465">
            <div class="contentauthoring_cell_element_actions" style="display:none;" data-element-id="245462465" data-element-type="htmlblock">
                <button class="contentauthoring_cell_element_action_x">X</button>
                <button class="contentauthoring_cell_element_action_e">E</button>
            </div>
            ${data.content}
        </div>
    {/if}
--></div>

<div id="contentauthoring_no_content_template" style="display:none;"><!--
    {if canEdit}
        <div class="contentauthoring_empty_content contentauthoring_default_editable_content_imagecontainer"></div>
    {else}
        <div class="contentauthoring_empty_content contentauthoring_default_viewable_content_imagecontainer"></div>
    {/if}
--></div>

<!-- Widget Settings -->
<div id="contentauthoring_widget_settings" class="s3d-dialog s3d-dialog-container">
    <div class="s3d-dialog-close jqmClose"></div>
    <h1 class="s3d-dialog-header" id="contentauthoring_widget_settings_title"></h1>
    <div id="contentauthoring_widget_settings_content"></div>
</div>

<!-- Autosave dialog -->
<div id="autosave_dialog" class="s3d-dialog s3d-dialog-container" style="width:450px; margin-left: -225px">
    <div class="s3d-dialog-close jqmClose"></div>
    <h1 id="entity_content_users_dialog_heading" class="s3d-dialog-header">__MSG__AUTOSAVE__</h1>
    <div>
        <h3 style="margin-top:0px">__MSG__AN_UNSAVED_VERSION_OF_PAGE_HAS_BEEN_FOUND__.</h3>
        <p>__MSG__DO_YOU_WANT_TO_LOAD_UNSAVED_VERSION__?</p>
        <div class="fl-force-right">
            <button type="button" class="s3d-button s3d-link-button" id="autosave_keep">__MSG__NO__</button>
            <button type="button" class="s3d-button s3d-overlay-action-button" id="autosave_revert">__MSG__YES__</button>
        </div>
    </div>
</div>

<div id="contentauthoring_dummy_element_template"><!--<div class="contentauthoring_dummy_element" style="display:none;">__MSG__DOUBLE_CLICK_TO_START_TYPING__.</div>--></div>

<!-- JAVASCRIPT -->
<script type="text/javascript" src="/devwidgets/contentauthoring/javascript/contentauthoring.js"></script>
